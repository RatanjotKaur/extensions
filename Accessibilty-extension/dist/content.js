const s=document.documentElement;function y(t){s.classList.toggle("big-text",t.bigText),s.classList.toggle("bold-text",t.boldText),s.classList.toggle("high-contrast",t.highContrast),s.classList.toggle("grayscale",t.grayscale),s.classList.toggle("invert",t.invert),s.classList.toggle("hide-images",t.hideImages),s.classList.toggle("highlight-links",t.highlightLinks),s.classList.toggle("black-cursor",t.blackCursor),s.classList.toggle("white-cursor",t.whiteCursor),s.classList.toggle("seizure-safe",t.seizureSafe)}let g=!1,e=null,n=null,d=null;function f(){if(e)return;e=document.createElement("div"),e.id="mgl-lens",e.style.position="fixed",e.style.width="180px",e.style.height="180px",e.style.borderRadius="50%",e.style.overflow="hidden",e.style.pointerEvents="none",e.style.zIndex="2147483647",e.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)",n=document.documentElement.cloneNode(!0);const t=n.querySelector("#mgl-lens");t&&t.parentNode&&t.parentNode.removeChild(t),n.style.transform="scale(2)",n.style.transformOrigin="0 0",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px",e.appendChild(n),document.body.appendChild(e),d=h=>{if(!e||!n)return;const l=e.getBoundingClientRect(),r=h.clientX,c=h.clientY;e.style.left=r-l.width/2+"px",e.style.top=c-l.height/2+"px";const i=2,o=-r*i+l.width/2,a=-c*i+l.height/2;n.style.transform=`translate(${o}px, ${a}px) scale(${i})`},window.addEventListener("mousemove",d)}function m(){d&&window.removeEventListener("mousemove",d),d=null,e&&e.parentNode&&e.parentNode.removeChild(e),e=null,n=null}chrome.runtime.onMessage.addListener((t,h,l)=>{var r,c;if(t){if(t.action){if(t.action==="magnifier-toggle"&&(g=!g,g?f():m()),t.action==="speak-selection"){const i=(c=(r=window.getSelection())==null?void 0:r.toString())==null?void 0:c.trim();if(i)try{chrome.storage.sync.get(["ttsVoice","ttsRate"],o=>{const a=new SpeechSynthesisUtterance(i);if(o.ttsVoice){const u=speechSynthesis.getVoices().find(p=>p.name===o.ttsVoice);u&&(a.voice=u)}a.rate=o.ttsRate||1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(a)})}catch(o){console.error("TTS error:",o)}}return}y(t)}});
